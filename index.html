<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador de Desconto de Energia</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f9;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
}

.top-image {
  width: 100%;
  max-width: 400px;
  height: 150px;
  background: url("LOGO-03.png") no-repeat center;
  background-size: contain;
  margin: 20px auto;
}

.container {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 420px;
}

label {
  font-weight: bold;
  margin-top: 10px;
  display: block;
}

input, select {
  width: 100%;
  padding: 7px;
  margin-top: 5px;
  margin-bottom: 15px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

button {
  background: #28a745;
  color: white;
  border: none;
  padding: 12px;
  width: 100%;
  border-radius: 6px;
  font-size: 18px;
  cursor: pointer;
}

.resultado {
  margin-top: 20px;
  padding: 15px;
  background: #f9f9f9;
  border-radius: 8px;
  border: 1px solid #ddd;
}

.aviso {
  margin-top: 10px;
  color: #b22222;
  font-weight: bold;
  text-align: center;
}

#btnWhatsApp {
  background-color: #25D366;
  margin-top: 10px;
  display: none;
}
</style>
</head>

<body>

<div class="top-image"></div>

<div class="container">
<h2>Simule seu Desconto</h2>

<label>Classe da Unidade:</label>
<select id="classe">
  <option value="">Selecione</option>
  <option value="residencial">Classe Residencial</option>
  <option value="nao">Classe NÃ£o Residencial</option>
</select>

<label>IluminaÃ§Ã£o PÃºblica (R$):</label>
<input type="number" id="iluminacao" placeholder="Ex: 17,65">

<label>Consumo Mensal (kWh):</label>
<input type="number" id="consumo" placeholder="Ex: 220">

<button onclick="calcular()">Calcular</button>

<div class="resultado" id="resultado"></div>
<div class="aviso" id="aviso"></div>

<button id="btnWhatsApp" onclick="enviarWhatsApp()">ðŸ“² Enviar resultado pelo WhatsApp</button>
</div>

<script>
let valorTotal = 0;

// Tabelas de CIP
const cipResidencial = [
  {max:30, pct:0.0072},{max:100, pct:0.0107},{max:150, pct:0.0252},
  {max:200, pct:0.0268},{max:250, pct:0.0284},{max:350, pct:0.0669},
  {max:400, pct:0.0671},{max:500, pct:0.0682},{max:800, pct:0.1387},
  {max:1000, pct:0.1905},{max:2000, pct:0.3466},{max:Infinity, pct:0.3590}
];

const cipNaoResidencial = [
  {max:30, pct:0.0116},{max:100, pct:0.0259},{max:150, pct:0.0663},
  {max:200, pct:0.0682},{max:250, pct:0.0691},{max:350, pct:0.1638},
  {max:400, pct:0.1652},{max:500, pct:0.1654},{max:800, pct:0.3671},
  {max:1000, pct:0.3772},{max:2000, pct:0.7750},{max:Infinity, pct:0.8549}
];

function obterCIP(consumo, classe) {
  const tabela = classe === "residencial" ? cipResidencial : cipNaoResidencial;
  return tabela.find(f => consumo <= f.max).pct;
}

function calcular() {
  const iluminacao = parseFloat(iluminacaoInput.value) || 0;
  const consumo = parseFloat(consumoInput.value) || 0;
  const classe = document.getElementById("classe").value;

  if (!classe || consumo <= 0) {
    alert("Preencha todos os campos corretamente.");
    return;
  }

  const tarifaTE = 0.32165;
  const tarifaTUSD = 0.60988;
  const adcBandeira = 0.10333;

  let valorEnergia = consumo * (tarifaTE + tarifaTUSD + adcBandeira);

  let pctCIP = obterCIP(consumo, classe);
  let valorCIP = valorEnergia * pctCIP;

  valorTotal = valorEnergia + valorCIP + iluminacao;

  let desconto = valorTotal >= 1000 ? 0.20 : valorTotal >= 300 ? 0.15 : 0;
  let valorFinal = valorTotal * (1 - desconto);

  resultado.innerHTML = `
    <p><strong>Classe:</strong> ${classe.toUpperCase()}</p>
    <p><strong>Valor Energia:</strong> R$ ${valorEnergia.toFixed(2)}</p>
    <p><strong>CIP (${(pctCIP*100).toFixed(2)}%):</strong> R$ ${valorCIP.toFixed(2)}</p>
    <p><strong>Fatura estimada:</strong> R$ ${valorTotal.toFixed(2)}</p>
    <p><strong>Fatura com desconto:</strong> R$ ${valorFinal.toFixed(2)}</p>
  `;

  btnWhatsApp.style.display = valorTotal > 300 ? "block" : "none";
  aviso.textContent = valorTotal <= 300 ? "âš ï¸ Faturas abaixo de R$ 300 nÃ£o aderem ao desconto." : "";
}

function enviarWhatsApp() {
  const texto = encodeURIComponent(document.getElementById("resultado").innerText);
  window.open(`https://wa.me/5585999416424?text=${texto}`, "_blank");
}

const iluminacaoInput = document.getElementById("iluminacao");
const consumoInput = document.getElementById("consumo");
const resultado = document.getElementById("resultado");
const aviso = document.getElementById("aviso");
const btnWhatsApp = document.getElementById("btnWhatsApp");
</script>

</body>
</html>
