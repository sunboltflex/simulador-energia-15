<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador de Desconto de Energia</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f9;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
  margin: 0;
}

.top-image {
  width: 100%;
  max-width: 400px;
  height: 150px;
  background: url("LOGO-03.png") no-repeat center;
  background-size: contain;
  margin: 20px auto;
}

.container {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 420px;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

label {
  font-weight: bold;
  margin-top: 10px;
  display: block;
}

input, select {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  margin-bottom: 15px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  background: #28a745;
  color: #fff;
  border: none;
  padding: 12px;
  width: 100%;
  border-radius: 6px;
  font-size: 18px;
  cursor: pointer;
}

button:hover {
  background: #218838;
}

.resultado {
  margin-top: 20px;
  padding: 15px;
  background: #f9f9f9;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 16px;
}

.aviso {
  margin-top: 10px;
  color: #b22222;
  font-weight: bold;
  text-align: center;
}

#btnWhatsApp {
  background-color: #25D366;
  color: white;
  display: block;
  margin-top: 10px;
  visibility: hidden;
}

#btnWhatsApp:hover {
  background-color: #1ebe5b;
}
</style>
</head>

<body>

<div class="top-image"></div>

<div class="container">
<h2>Simule seu Desconto</h2>

<label>Classe da Unidade:</label>
<select id="classe">
  <option value="">Selecione</option>
  <option value="residencial">Classe Residencial</option>
  <option value="nao">Classe NÃ£o Residencial</option>
</select>

<label>Consumo Mensal (kWh):</label>
<input type="number" id="consumo" min="1" placeholder="Ex: 850">

<button id="btnCalcular" onclick="calcular()">Calcular</button>
<button id="btnWhatsApp" onclick="enviarWhatsApp()">ðŸ“² Enviar resultado pelo WhatsApp</button>

<div class="resultado" id="resultado"></div>
<div class="aviso" id="aviso"></div>
</div>

<script>
let valorTotal = 0;
let desconto = 0;
let valorFinal = 0;
let descontoMensal = 0;
let descontoAnual = 0;

const BASE_CREDITO = 950;

const cipResidencial = [
  {max:30, pct:0.0072},{max:100, pct:0.0107},{max:150, pct:0.0252},
  {max:200, pct:0.0268},{max:250, pct:0.0284},{max:350, pct:0.0669},
  {max:400, pct:0.0671},{max:500, pct:0.0682},{max:800, pct:0.1387},
  {max:1000, pct:0.1905},{max:2000, pct:0.3466},{max:Infinity, pct:0.3590}
];

const cipNaoResidencial = [
  {max:30, pct:0.0116},{max:100, pct:0.0259},{max:150, pct:0.0663},
  {max:200, pct:0.0682},{max:250, pct:0.0691},{max:350, pct:0.1638},
  {max:400, pct:0.1652},{max:500, pct:0.1654},{max:800, pct:0.3671},
  {max:1000, pct:0.3772},{max:2000, pct:0.7750},{max:Infinity, pct:0.8549}
];

function obterCIP(consumo, classe) {
  const tabela = classe === "residencial" ? cipResidencial : cipNaoResidencial;
  return tabela.find(f => consumo <= f.max).pct;
}

function formatar(valor) {
  return valor.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
}

function calcular() {
  const consumo = parseFloat(document.getElementById("consumo").value);
  const classe = document.getElementById("classe").value;

  if (!classe || !consumo || consumo <= 0) {
    alert("Preencha corretamente os campos.");
    return;
  }

  const pctCIP = obterCIP(consumo, classe);
  const valorCIP = BASE_CREDITO * pctCIP;

  valorTotal = consumo + valorCIP;

  if (valorTotal >= 300 && valorTotal < 1000) desconto = 0.15;
  else if (valorTotal >= 1000 && valorTotal <= 2000) desconto = 0.20;
  else if (valorTotal > 2000) desconto = 0.25;
  else desconto = 0;

  descontoMensal = valorTotal * desconto;
  descontoAnual = descontoMensal * 12;
  valorFinal = valorTotal - descontoMensal;

  document.getElementById("resultado").innerHTML = `
    <p><strong>Consumo informado:</strong> ${consumo} kWh</p>
    <p><strong>Valor da fatura:</strong> ${formatar(valorTotal)}</p>
    <p><strong>Desconto aplicado:</strong> ${(desconto*100).toFixed(0)}%</p>
    <p><strong>Desconto mensal:</strong> ${formatar(descontoMensal)}</p>
    <p><strong>Desconto anual:</strong> ${formatar(descontoAnual)}</p>
    <p><strong>Fatura com desconto:</strong> ${formatar(valorFinal)}</p>
  `;

  document.getElementById("btnWhatsApp").style.visibility =
    valorTotal >= 300 ? "visible" : "hidden";

  document.getElementById("aviso").textContent =
    valorTotal < 300 ? "âš ï¸ Faturas abaixo de R$ 300,00 nÃ£o podem aderir ao desconto." : "";
}

function enviarWhatsApp() {
  if (valorTotal < 300) return;

  const mensagem = `
RESULTADO DA SIMULAÃ‡ÃƒO

Consumo: ${document.getElementById("consumo").value} kWh
Valor da fatura: ${formatar(valorTotal)}

Desconto aplicado: ${(desconto*100).toFixed(0)}%
Desconto mensal: ${formatar(descontoMensal)}
Desconto anual: ${formatar(descontoAnual)}

Fatura com desconto: ${formatar(valorFinal)}

âš ï¸ Valores simulados.
`;

  window.open(
    "https://wa.me/5585999416424?text=" + encodeURIComponent(mensagem),
    "_blank"
  );
}
</script>

</body>
</html>
